<div class="loading-overlay" id="settings_loading_wheel">
    <div class="loading_spinner" role="status">
      <span class="visually-hidden"></span>
    </div>
</div>

<style>
    .loading-overlay {
        position: absolute;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: black;
        opacity: 50%;
        z-index: 150;
        display: none;
        transition: opacity 0.5s ease;
    }

    .loading_spinner {
        z-index: 151;
        margin: auto;
        margin-left: 50%;
        margin-top: 25%;
        width: 50px;
        height: 50px;
    }
</style>

<div class="main_settings_container">


    <!-- Sidebar -->
    <div class="settings_sidebar">
        <div class="settings_sidebar_title">
            <span data-i18n="settings"></span>
        </div>
        <hr>
        <div class="settings_sidebar_section">
            <ul class="settings_sidebar_section_list">
                <li onclick="showProfileSection()" class="settings_sidebar_section_list_item" id="settings_nav_profile"
                    data-i18n="profile"></li>
                <li onclick="showConfidentialitySection()" class="settings_sidebar_section_list_item"
                    id="settings_nav_confidentiality" data-i18n="confidentiality"></li>
                <li onclick="showAccountSection()" class="settings_sidebar_section_list_item" id="settings_nav_account"
                    data-i18n="account"></li>
            </ul>
        </div>
        <span onclick="navigate('/profile')" class="settings_sidebar_back" data-i18n="back_to_profile"></span>
    </div>
    <!-- Settings panel -->
    <div class="settings_panel">

        <!-- Back button -->
        <div class="settings_panel_top_section">
            <div class="settings_panel_section_title">
                <span id="settings_section_title"></span>
            </div>
            <div onclick="navigate('/profile')" class="settings_panel_back_button">
                <span><i class="fa-solid fa-xmark"></i></span>
            </div>
        </div>

        <hr>

        <div id="settings_error_div" style="display: none; padding: 10px; background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; border-radius: 5px;">
            <h5 id="settings_error_title" style="margin: 0;"></h5>
            <span id="settings_error_content"></span>
        </div>
        
        <div id="settings_success_div" style="display: none; padding: 10px; background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; border-radius: 5px;">
            <h5 id="settings_success_title" style="margin: 0;"></h5>
            <span id="settings_success_content"></span>
        </div>
        <br>

        <!-- Profile -->
        <section class="settings_panel_section" id="settings_profile_section">

            <form class="settings_panel_form" id="settings_panel_form_profile" method="POST" action=""
                  enctype="multipart/form-data">

                <div class="settings_panel_form_content">

                    <div class="settings_panel_form_section">
                        <div class="settings_panel_form_item">
                            <label for="settings_user_displayname" class="form-label" data-i18n="display_name">Display
                                Name</label>
                            <div class="">
                                <span class="">@</span>
                                <input name="display_name" type="text" id="settings_user_displayname"
                                       class="user_input_item" data-i18n-placeholder="display_name_placeholder"
                                       aria-label="Display name" aria-describedby="basic-addon1">
                            </div>
                            <div style="color: var(--light-beige); opacity: 80%;" class="form-text" data-i18n="display_name_settings_desc"></div>
                        </div>

                        <div class="settings_panel_form_item">
                            <label for="settings_user_github" class="" data-i18n="your_github_url"></label>
                            <div class="">
                                <span class="" id="settings_user_github_l">https://github.com/</span>
                                <input name="github_url" type="text" class="user_input_item" id="settings_user_github">
                            </div>
                        </div>

                        <div class="settings_panel_form_item">
                            <label for="settings_user_avatar" class="" data-i18n="profile_picture"></label>
                            <br>
                            <input name="avatar" class="user_input_item" type="file" id="settings_user_avatar">
                            <div style="color: var(--light-beige); opacity: 80%;" class="form-text" data-i18n="valid_picture_desc"></div>

                        </div>

                    </div>

                    <div class="settings_panel_form_section">

                        <div class="settings_panel_form_item">
                            <label for="settings_user_status" class="" data-i18n="status_message"></label>
                            <input name="status_message" type="text" class="user_input_item" id="settings_user_status"
                                   aria-describedby="Status" data-i18n-placeholder="status_message_placeholder">
                            <div style="color: var(--light-beige); opacity: 80%;" class="form-text" data-i18n="status_message_desc"></div>

                        </div>

                        <div class="settings_panel_form_item">
                            <label for="settings_user_lang" class="" data-i18n="language"></label>
                            <select name="lang" class="user_input_item" id="settings_user_lang"></select>
                        </div>

                    </div>
                </div>
                <button type="submit" class="custom_button custom_button_green_fill settings_panel_save" data-i18n="save"></button>
            </form>
        </section>
        <!-- Confidentiality -->
        <section class="settings_panel_section" id="settings_confidentiality_section">
            <form class="settings_panel_form" id="settings_panel_form_confidentiality" method="POST" action=""
                  enctype="multipart/form-data">

                <div class="settings_panel_form_content">

                    <div class="settings_panel_form_section">
                        <div class="settings_panel_form_item">
                            <span class="" data-i18n="profile_visibility"></span>
                            <br>
                            <select name="profile_visibility" id="" class="user_input_item">
                                <option value="public" data-i18n="public" id="profile_visibility_public"></option>
                                <option value="private" data-i18n="private" id="profile_visibility_private"></option>
                            </select>
                            <div style="color: var(--light-beige); opacity: 80%;" class="form-text" data-i18n="profile_visibility_desc"></div>
                        </div>

                        <div class="settings_panel_form_item">
                            <div>
                                <label for="profile_show_fullname" data-i18n="show_fullname"></label>
                                <label for="profile_show_fullname" class="custom_input_switch">
                                    <input class="custom_input_check" type="checkbox" id="profile_show_fullname" name="profile_show_fullname">
                                    <span class="custom_check_slider"></span>
                                </label>
                            </div>
                        </div>
                        

                        <div class="settings_panel_form_item">
                            <div>
                                <label for="profile_show_email" data-i18n="show_email"></label>
                                <label for="profile_show_email" class="custom_input_switch">
                                    <input class="custom_input_check" type="checkbox" id="profile_show_email" name="profile_show_email">
                                    <span class="custom_check_slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="settings_panel_form_section">

                        <div class="settings_panel_form_item">
                            <label class="" for="cookies_revoke" data-i18n="cookies_preferences"></label>
                            <div>
                                <label for="cookies_revoke" data-i18n="revoke_cookies"></label>
                                <label for="cookies_revoke" class="custom_input_switch">
                                    <input class="custom_input_check" type="checkbox" id="cookies_revoke" name="revoke_cookies">
                                    <span class="custom_check_slider"></span>
                                </label>
                            </div>
                            <div style="color: var(--light-beige); opacity: 80%;" class="form-text" data-i18n="revoke_cookies_desc">
                            </div>
                        </div>
                        

                        <div class="settings_panel_form_item">

                        </div>
                    </div>
                </div>
                <button type="submit" class="custom_button custom_button_green_fill settings_panel_save" data-i18n="save"></button>
            </form>
        </section>
        <!-- Account -->
        <section class="settings_panel_section" id="settings_account_section">
            <form class="settings_panel_form" id="settings_panel_form_account" method="" action=""
                  enctype="multipart/form-data">
                <div class="settings_panel_form_section">

                    <div class="settings_panel_form_item">

                        <h5 data-i18n="account_deletion"></h5>
                        <div style="color: var(--light-beige); opacity: 80%;" class="form-text"><span
                                data-i18n="account_deletion_desc"></span></div>
                    </div>
                </div>


                <span type="button" class="custom_button custom_button_red_fill settings_panel_save" id="delete" data-i18n="delete_account"></span>
               
                <div id="accountDeletionModal" class="custom-modal">
                    <div class="custom-modal-dialog">
                        <div class="custom-modal-content">
                            <div class="custom-modal-header">
                                <h1 id="staticBackdropLabel" data-i18n="confirmation_title"></h1>
                                <button type="button" class="close-btn" onclick="closeModal('accountDeletionModal')">×</button>
                            </div>
                            <div class="custom-modal-body">
                                <span data-i18n="account_deletion_desc"></span>
                            </div>
                            <div class="custom-modal-footer">
                                <button type="button" class="custom_button custom_button_green" onclick="closeModal('accountDeletionModal')" data-i18n="cancel"></button>
                                <button type="submit" class="custom_button custom_button_red_fill" onclick="deleteAccount()" data-i18n="delete"></button>
                            </div>
                        </div>
                    </div>
                </div>
                
            </form>
        </section>
    </div>
</div>

<script>
    function openModal(id) {
        document.getElementById(id).classList.add('show-modal');
    }
    function closeModal(id) {
        document.getElementById(id).classList.remove('show-modal');
    }
    function deleteAccount() {
        closeModal();
    }
    document.getElementById('delete').addEventListener('click', () => {
        openModal('accountDeletionModal');
    });
</script>

<script src="../../js/users_service/user_settings.js"></script>
