<div>
    <h1>Lobby</h1>
    <h2>Host: </h2>
    <div>
        <h3>Participants <span>x/8</span></h3>
        <span>player</span><br>
        <span>player</span><br>
        <span>player</span><br>
    </div>
    <button>Leave tournament</button>
    
    <!-- Host only -->
    <button onclick="destroyTournament()">Delete tournament</button> 
</div>


<script>

    async function checkTournamentId()
    {
        let tournamentParams = new URLSearchParams(window.location.search);
        let tournamentId = tournamentParams.get("tid");

        if (tournamentId == undefined) {
            navigate("/tournament");
            return;
        }

        // Check if player participates
        let userParticipates = await doesPlayerParticipate(tournamentId);
        console.log("Participates: " + userParticipates);
        if (!userParticipates) {
            navigate("/tournament");
            return ;
        }

        // Check tournament state
        let tournamentState = await getTournamentState(tournamentId);
        console.log(tournamentState);
        if (tournamentState == "ongoing") {
            navigate(`/tournament/rounds/?tid=${tournamentId}`);
            return ;
        } else if (tournamentState == "finished") {
            navigate("/tournament");
            return ;
        }

        console.log("All checks valid");
    
    }

    async function destroyTournament()
    {
        let tournamentParams = new URLSearchParams(window.location.search);
        let tournamentId = tournamentParams.get("tid");

        if (tournamentId == undefined) {
            navigate("/tournament");
            return;
        }

        deleteTournament(tournamentId);
    }

    checkTournamentId();

</script>